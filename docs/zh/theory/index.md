# 1.进程？线程？

::: tip 进程
运行状态的程序需要有自己专属的内存空间，这块空间可以理解为进程  
每个应用至少有一个进程，进程之间相互独立，即使需要通信，也要经过双方进程的同意
:::
::: tip 线程
有了进程之后，就可以运行程序的代码了。运行代码的单位，称之为‘线程’  
一个进程至少有一个线程，所以当开启进程之后会自动创建一个线程来执行代码，这个线程称之为‘主线程’，如果程序需要同时执行多块代码，主线程就会启动更多线程来执行代码，所以一个进程可以拥有多个线程
:::

# 2.浏览器有哪些进程和线程

浏览器是一个多进程多线程的应用程序，为了避免相互影响，减少连环崩溃的概率，当启动浏览器后，会自动启动多个进程  
其中最主要的进程有：
::: tip 浏览器进程
主要负责界面显示、用户交互、子进程管理等。浏览器进程内部会启动多个线程处理不同的任务
:::
::: tip 网络进程
负责加载网络资源。网络进程内部会启动多个线程来处理不同的网络任务
:::
::: tip 渲染进程：
渲染进程启动后，会开启一个渲染主线程，主要负责执行 HTML、CSS、JS 代码。默认情况下，浏览器会为每一个标签页开启一个渲染进程，以保证每个标签页之前相互独立
:::

# 3.事件循环机制

渲染主线程需要处理许多任务，任务调度是一个难题，因此渲染主线程使用‘排队’策略来解决这个难题，此过程则称为“事件循环”

::: danger

1. 在最开始的时候，渲染主线程会进入一个无限循环
2. 每一次循环会优先检测**微队列**中是否有任务存在。如果有，就取出第一个任务执行，执行完一个进入下一次事件循环；若微队列为空，则检测其他队列是否存在任务，浏览器**自行决定**取哪一个队列的任务执行；如果没有，则进入休眠状态
3. 其他所有线程（包括其他进程的线程）可以随时向各个消息队列添加任务。新任务会加入到各队列的末尾，在添加新任务时，如果主线程时休眠状态，则会唤醒以继续循环拿取任务
   :::

# 4.如何理解 JS 的异步

首先 JS 是一门**单线程语言**，这是因为他运行在浏览器的渲染主线程中，而渲染主线程只有一个。渲染主线程承担着许多工作，例如渲染页面、执行 JS 代码  
::: warning
如果使用同步的方式，就极有可能导致主线程产生阻塞，从而导致消息队列中的很多其他任务无法得到执行。这样一来，一方面会导致繁忙的渲染主线程白白消耗时间，另一方面导致页面无法及时更新，给用户造成卡死现象  
**所以浏览器采用异步的方式来避免。具体做法是当某些任务发生时，比如计时器、网络、事件监听，主线程将任务交给其他线程去处理，自身立即结束任务的执行，转而执行后续代码。当其他线程完成时，将事件传递的回调函数包装成任务，加入到消息队列的末尾排队，等待主线程调度执行**
:::
在这种异步模式下，浏览器永不阻塞，从而最大限度的保证了单线程的执行流畅
